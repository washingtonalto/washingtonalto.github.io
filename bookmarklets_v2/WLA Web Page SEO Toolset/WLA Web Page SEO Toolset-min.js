(async()=>{if(["RadioChoicePopup","BrowserTab","PageProperty","ListofObj_Base","ListofObj_to_Table","ListofObj_to_DelimitedText"].every((e=>void 0===globalThis[e]))){class e{constructor({title:e="Choose an option",message:t="",options:o=[{label:"Option A",value:"A"},{label:"Option B",value:"B"}]}={}){this.title=e,this.message=t,this.options=o,this.id="radio-choice-popup"}show(){return new Promise((e=>{const t=document.getElementById(this.id);t&&t.remove();const o=document.createElement("div");o.id=this.id,o.innerHTML=`\n        <div style="\n          position:fixed;\n          inset:0;\n          background:rgba(0,0,0,0.45);\n          display:flex;\n          align-items:center;\n          justify-content:center;\n          z-index:2147483647;\n          font-family:Arial,sans-serif;\n        ">\n          <div style="\n            background:#fff;\n            padding:16px 18px;\n            width:320px;\n            border-radius:8px;\n            box-shadow:0 10px 25px rgba(0,0,0,.25);\n          ">\n            <div style="font-size:16px;font-weight:bold;margin-bottom:8px;">\n              ${this.title}\n            </div>\n\n            ${this.message?`<div style="margin-bottom:10px;font-size:13px;">${this.message}</div>`:""}\n\n            <form id="rcp-form">\n              ${this.options.map(((e,t)=>`\n                    <label style="display:block;margin:6px 0;font-size:13px;">\n                      <input\n                        type="radio"\n                        name="rcp"\n                        value="${e.value}"\n                        ${0===t?"checked":""}\n                      >\n                      ${e.label}\n                    </label>\n                  `)).join("")}\n\n              <div style="margin-top:12px;text-align:right;">\n                <button type="button" id="rcp-cancel">Cancel</button>\n                <button type="submit" style="margin-left:8px;">OK</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      `,document.body.appendChild(o);const n=t=>{o.remove(),e(t)};o.querySelector("#rcp-cancel").onclick=()=>{n(null)},o.querySelector("#rcp-form").onsubmit=e=>{e.preventDefault();const t=o.querySelector('input[name="rcp"]:checked');n(t?t.value:null)}}))}}class t{static openWithHTML(e,t="_blank"){const o=window.open("",t);if(o)try{o.document.open(),o.document.write(e),o.document.close(),o.focus()}catch(e){}else alert("Popup blocked. Please allow popups for this site.")}}class o{pageTitle="";objProperty={};constructor(e,t=""){this.pageTitle=t,this.objProperty=e}displayPageHeaders(){let e=this.pageTitle,t="<TITLE>"+e+"</TITLE>";t+="<H1>"+e+"</H1>";for(let e in this.objProperty)t+="<STRONG>"+e+"</STRONG>: ",t+=o.formatObjvalues(this.objProperty[e])+"<BR>";return t+="<BR>",t}displayPageFooters(){return"\n                    <BR><BR>\n                    <DIV style='text-align: center;'>\n                        <CITE>Copyright: (c) 2026, Washington Alto</CITE>\n                    </DIV>\n                "}static isValidHttpUrl(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}}static formatObjvalues(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;"},n=e=>t[e]||e;let l;return l=o.isValidHttpUrl(e)?`\n                        <A HREF="${e}" target="_blank">\n                            ${decodeURIComponent(e)}\n                        </A>\n                    `:null==e||0===String(e).trim().length?"":String(e).trim().replace(/[&<>]/g,n),l}}class n{header=["No."];fields=[];collection=[];schema=[];title="";constructor(e,t){this.header=this.header.concat(Object.keys(e)),this.fields=Object.values(e),this.collection=t,this.schema=e}setTitle(e=""){this.title=e}resolveField(e,t){return"function"==typeof t?t(e):(o=e,t.split(".").reduce(((e,t)=>e&&e[t]),o));var o}buildRows(){const e=[];for(let t=0;t<this.collection.length;t++){const o=this.collection[t],n=this.fields.map((e=>this.resolveField(o,e)));e.push([t+1,...n])}return e}static formatValue(e){return null==e?"":"object"==typeof e?Array.from(e).map((e=>`${e.name}: ${e.value}`)).join("; "):String(e).trim()}}class l extends n{objCSV="";static tableStyle(e="#FFC107"){return`\n      <STYLE>\n        table, th, td {\n          border: 1px solid #9E9E9E;\n          border-collapse: collapse;\n        }\n        th { background: ${e}; }\n      </STYLE>\n    `}render(e="download.csv"){let t="";this.title&&(t+=`<H1>${this.title}</H1>`),t+=l.tableStyle(),t+="<TABLE><TR>",this.header.forEach((e=>t+=`<TH>${e}</TH>`)),t+="</TR>";this.buildRows().forEach((e=>{t+="<TR>",e.forEach((e=>{t+=`<TD>${n.formatValue(e)}</TD>`})),t+="</TR>"})),t+="</TABLE><BR>";const o=new i(this.schema,this.collection,{columnDelimiter:",",rowDelimiter:"\r\n"});return this.objCSV=o.render(),t+=l.createCSVBloblink(this.objCSV,e),t}static createCSVBloblink(e,t="download.csv"){let o=new Blob([e],{type:"text/csv"});return'<A href="'+window.URL.createObjectURL(o)+'" download="'+t+'">Download as CSV</A>'}}class i extends n{constructor(e,t,o={}){super(e,t),this.columnDelimiter=o.columnDelimiter??",",this.rowDelimiter=o.rowDelimiter??"<BR>"}render(){let e="";this.title&&(e+=`<STRONG>${this.title}</STRONG>`+this.rowDelimiter),e+=this.header.join(this.columnDelimiter)+this.rowDelimiter;return this.buildRows().forEach((t=>{e+=t.map((e=>n.formatValue(i.escapeForCSV(i.formatCSVcellvalues(e))))).join(this.columnDelimiter)+this.rowDelimiter})),e}static escapeForCSV(e){return/[",\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e}static formatCSVcellvalues(e){let t;return t="object"==typeof e?function(e){let t="";for(let o=0;o<e.length;o++)t+=e[o].name+": "+e[o].value+";\n\r";return t}(e):String(e).trim(),t}}const r=new e({title:"SEO Web Page SEO Toolset",message:"Select the bookmarklet tool:",options:[{label:"Link Tool",value:"Link Tool"},{label:"Image Tool",value:"Image Tool"},{label:"Cookie Tool",value:"Cookie Tool"},{label:"Script Tool",value:"Script Tool"},{label:"HTTP Resource Tool",value:"HTTP Resource Tool"},{label:"H1 to H6 Header Tool",value:"H1 to H6 Header Tool"},{label:"Meta Tag Tool",value:"Meta Tag Tool"},{label:"HTTP Response Headers Tool",value:"HTTP Response Headers Tool"}]}),a=await r.show();if("Link Tool"===a)listofObject=document.links,tableschema={"Link URL":"href","Link Text":"innerText","Link outerHTML":"outerHTML","Link attributes":"attributes"};else if("Image Tool"===a)listofObject=document.images,tableschema={"Image URL":"src","Image Height":"height","Image Width":"width","Image Alt":"alt","Image Loading":"loading","Image srcset":"srcset","Image sizes":"sizes","Image attributes":"attributes"};else if("Cookie Tool"===a)listofObject=function(e){const t=[];return Object.keys(e).forEach(((o,n)=>{const l={name:o,value:e[o]};t.push(l),t[n]=l,o in t||(t[o]=l)})),Object.defineProperties(t,{length:{value:t.length,writable:!1},item:{value(e){return this[e]||null}},namedItem:{value(e){return this[e]||null}}}),t}(document.cookie?document.cookie.split("; ").reduce(((e,t)=>{const o=t.indexOf("=");if(-1===o)return e;const n=t.slice(0,o).trim(),l=t.slice(o+1);try{e[n]=decodeURIComponent(l)}catch{e[n]=l}return e}),{}):{}),tableschema={"Cookie Name":"name","Cookie Value":"value"};else if("Script Tool"===a)listofObject=document.scripts,tableschema={"Script id":"id","Script src":"src","Script async":"async","Script outerText":"outerText"};else if("HTTP Resource Tool"===a)listofObject=performance.getEntriesByType("resource"),tableschema={"Resource Type":"initiatorType","Resource Name":"name"};else if("H1 to H6 Header Tool"===a)listofObject=function(){let e=new Array,t=Array.from(document.getElementsByTagName("H1")),o=Array.from(document.getElementsByTagName("H2")),n=Array.from(document.getElementsByTagName("H3")),l=Array.from(document.getElementsByTagName("H4")),i=Array.from(document.getElementsByTagName("H5")),r=Array.from(document.getElementsByTagName("H6"));return e=t.concat(o).concat(n).concat(l).concat(i).concat(r),e}(),tableschema={Name:"tagName",Content:e=>e.innerText.trim(),"Content Length":e=>e.innerText.trim().length};else if("Meta Tag Tool"===a)listofObject=document.querySelectorAll("meta[name]"),tableschema={Name:e=>e.attributes.name.value,Content:e=>String(e.attributes.content.value).trim(),"Content Length":e=>String(e.attributes.content.value).trim().length};else{if("HTTP Response Headers Tool"!==a)return void alert("User has clicked 'Cancel'");{let e=function(e){let t,o=new XMLHttpRequest;o.open("HEAD",e,!1);try{o.send()}catch(e){}return o.onload=function(){t=o.getAllResponseHeaders()},o.onload(),t}(location.href);listofObject=e.split("\n"),listofObject.pop(),tableschema={"Item-value Pair":e=>e}}}const s=new o({"Page URL":location.href,"Page Name":document.title,"Tool choice":a},"WLA Web Page SEO Toolset");let c=location.href+"_"+a+".csv",m=s.displayPageHeaders();m+=new l(tableschema,listofObject).render(c),m+=s.displayPageFooters(),t.openWithHTML(m)}})();