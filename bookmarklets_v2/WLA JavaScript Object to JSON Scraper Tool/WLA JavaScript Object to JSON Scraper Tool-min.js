!function(){if(["BrowserTab","PageProperty","Obj_to_JSON"].every((t=>void 0===globalThis[t]))){function t(t,e){return e.split(".").reduce(((t,e)=>t&&t[e]),t)}class e{static openWithHTML(t,e="_blank"){const o=window.open("",e);if(o)try{o.document.open(),o.document.write(t),o.document.close(),o.focus()}catch(t){}else alert("Popup blocked. Please allow popups for this site.")}}class o{pageTitle="";objProperty={};constructor(t,e=""){this.pageTitle=e,this.objProperty=t}displayPageHeaders(){let t=this.pageTitle,e="<TITLE>"+t+"</TITLE>";e+="<H1>"+t+"</H1>";for(let t in this.objProperty)e+="<STRONG>"+t+"</STRONG>: ",e+=o.formatObjvalues(this.objProperty[t])+"<BR>";return e+="<BR>",e}displayPageFooters(){return"\n                    <BR><BR>\n                    <DIV style='text-align: center;'>\n                        <CITE>Copyright: (c) 2026, Washington Alto</CITE>\n                    </DIV>\n                "}static isValidHttpUrl(t){try{const e=new URL(t);return"http:"===e.protocol||"https:"===e.protocol}catch(t){return!1}}static formatObjvalues(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;"},n=t=>e[t]||t;let r;return r=o.isValidHttpUrl(t)?`\n                        <A HREF="${t}" target="_blank">\n                            ${decodeURIComponent(t)}\n                        </A>\n                    `:null==t||0===String(t).trim().length?"":String(t).trim().replace(/[&<>]/g,n),r}}class n{strHTMLlines="";objJSON="";static setDivStyle(t,e){return`\n            <STYLE>\n                .propertyname { font-weight: bold; color: ${e}; }\n                .outputarea { background-color: ${t}; }\n            </STYLE>\n        `}constructor(e){this.inputObj=t(globalThis,e),this.inputObjname=e}static recursiveObjformat(t){let e="<DIV class='outputarea'><UL>";for(let o in t){if(!t.hasOwnProperty(o))continue;const n=t[o];if(e+=`<LI><SPAN class='propertyname'>${o}</SPAN>: `,null===n)e+="(null)";else if("function"==typeof n)e+=n.toString();else if(Array.isArray(n)){e+="<OL>";for(let t of n)e+="<LI>",e+=t&&"object"==typeof t?this.recursiveObjformat(t):t,e+="</LI>";e+="</OL>"}else e+="object"==typeof n?this.recursiveObjformat(n):n;e+="</LI>"}return e+"</UL></DIV>"}display(t="lightblue",e="blue",o="download.json"){let r=`<STRONG>Object selected</STRONG>: ${this.inputObjname}`;r+=n.setDivStyle(t,e),r+=n.recursiveObjformat(this.inputObj);const l=n.createobjJSON(this);return r+=n.createJSONBloblink(l,o),r}static createobjJSON(t){return JSON.stringify(t.inputObj,null,2)}static createJSONBloblink(t,e="download.json"){const o=new Blob([t],{type:"application/json"});return`\n            <A href="${URL.createObjectURL(o)}" download="${e}">\n                Download as JSON\n            </A><BR><BR>\n        `}}const r=prompt("Enter object to scrape (default: document.location):","document.location"),l=new o({"Page URL":location.href,"Page Name":document.title},"WLA JavaScript Object to JSON Scraper Tool ver 1");let i=l.displayPageHeaders(),a=function(t,e={}){const{replacement:o="_",maxLength:n=255}=e;if(!t||"string"!=typeof t)return"file";let r=t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[\x00-\x1F]/g,"").replace(/[\\\/:*?"<>|]/g,o).replace(/\s+/g," ").trim();if(r=r.replace(/[. ]+$/,""),r||(r="file"),/^(con|prn|aux|nul|com[1-9]|lpt[1-9])$/i.test(r)&&(r=`${r}_file`),r.length>n){const t=r.match(/(\.[^.]+)$/),e=t?t[1]:"",o=r.slice(0,n-e.length);r=o+e}return r}(r)+".json";!function(e){const o=t(globalThis,e);return"object"==typeof o&&null!==o}(r)?i+="Invalid object selected: "+r:i+=new n(r).display(void 0,void 0,a),i+=l.displayPageFooters(),e.openWithHTML(i)}}();