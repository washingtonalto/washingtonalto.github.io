(async()=>{if(["RadioChoicePopup","BrowserTab","PageProperty","ListofObj_Base","ListofObj_to_Table","ListofObj_to_DelimitedText"].every((e=>void 0===globalThis[e]))){function e(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}class i{constructor({title:e="Choose an option",message:t="",options:n=[{label:"Option A",value:"A"},{label:"Option B",value:"B"}]}={}){this.title=e,this.message=t,this.options=n,this.id="radio-choice-popup"}show(){return new Promise((e=>{const t=document.getElementById(this.id);t&&t.remove();const n=document.createElement("div");n.id=this.id,n.innerHTML=`\n        <div style="\n          position:fixed;\n          inset:0;\n          background:rgba(0,0,0,0.45);\n          display:flex;\n          align-items:center;\n          justify-content:center;\n          z-index:2147483647;\n          font-family:Arial,sans-serif;\n        ">\n          <div style="\n            background:#fff;\n            padding:16px 18px;\n            width:320px;\n            border-radius:8px;\n            box-shadow:0 10px 25px rgba(0,0,0,.25);\n          ">\n            <div style="font-size:16px;font-weight:bold;margin-bottom:8px;">\n              ${this.title}\n            </div>\n\n            ${this.message?`<div style="margin-bottom:10px;font-size:13px;">${this.message}</div>`:""}\n\n            <form id="rcp-form">\n              ${this.options.map(((e,t)=>`\n                    <label style="display:block;margin:6px 0;font-size:13px;">\n                      <input\n                        type="radio"\n                        name="rcp"\n                        value="${e.value}"\n                        ${0===t?"checked":""}\n                      >\n                      ${e.label}\n                    </label>\n                  `)).join("")}\n\n              <div style="margin-top:12px;text-align:right;">\n                <button type="button" id="rcp-cancel">Cancel</button>\n                <button type="submit" style="margin-left:8px;">OK</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      `,document.body.appendChild(n);const o=t=>{n.remove(),e(t)};n.querySelector("#rcp-cancel").onclick=()=>{o(null)},n.querySelector("#rcp-form").onsubmit=e=>{e.preventDefault();const t=n.querySelector('input[name="rcp"]:checked');o(t?t.value:null)}}))}}class r{static openWithHTML(e,t="_blank"){const n=window.open("",t);if(n)try{n.document.open(),n.document.write(e),n.document.close(),n.focus()}catch(e){}else alert("Popup blocked. Please allow popups for this site.")}}class l{pageTitle="";objProperty={};constructor(e,t=""){this.pageTitle=t,this.objProperty=e}displayPageHeaders(){let e=this.pageTitle,t="<TITLE>"+e+"</TITLE>";t+="<H1>"+e+"</H1>";for(let e in this.objProperty)t+="<STRONG>"+e+"</STRONG>: ",t+=l.formatObjvalues(this.objProperty[e])+"<BR>";return t+="<BR>",t}displayPageFooters(){return"\n                    <BR><BR>\n                    <DIV style='text-align: center;'>\n                        <CITE>Copyright: (c) 2026, Washington Alto</CITE>\n                    </DIV>\n                "}static isValidHttpUrl(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}}static formatObjvalues(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;"},n=e=>t[e]||e;let o;return o=l.isValidHttpUrl(e)?`\n                        <A HREF="${e}" target="_blank">\n                            ${decodeURIComponent(e)}\n                        </A>\n                    `:null==e||0===String(e).trim().length?"":String(e).trim().replace(/[&<>]/g,n),o}}class s{header=["No."];fields=[];collection=[];schema=[];title="";constructor(e,t){this.header=this.header.concat(Object.keys(e)),this.fields=Object.values(e),this.collection=t,this.schema=e}setTitle(e=""){this.title=e}resolveField(t,n){return"function"==typeof n?n(t):e(t,n)}buildRows(){const e=[];for(let t=0;t<this.collection.length;t++){const n=this.collection[t],o=this.fields.map((e=>this.resolveField(n,e)));e.push([t+1,...o])}return e}static formatValue(e){return null==e?"":"object"==typeof e?Array.from(e).map((e=>`${e.name}: ${e.value}`)).join("; "):String(e).trim()}}class a extends s{objCSV="";static tableStyle(e="#FFC107"){return`\n      <STYLE>\n        table, th, td {\n          border: 1px solid #9E9E9E;\n          border-collapse: collapse;\n        }\n        th { background: ${e}; }\n      </STYLE>\n    `}render(e="download.csv"){let t="";this.title&&(t+=`<H1>${this.title}</H1>`),t+=a.tableStyle(),t+="<TABLE><TR>",this.header.forEach((e=>t+=`<TH>${e}</TH>`)),t+="</TR>";this.buildRows().forEach((e=>{t+="<TR>",e.forEach((e=>{t+=`<TD>${s.formatValue(e)}</TD>`})),t+="</TR>"})),t+="</TABLE><BR>";const n=new c(this.schema,this.collection,{columnDelimiter:",",rowDelimiter:"\r\n"});return this.objCSV=n.render(),t+=a.createCSVBloblink(this.objCSV,e),t}static createCSVBloblink(e,t="download.csv"){let n=new Blob([e],{type:"text/csv"});return'<A href="'+window.URL.createObjectURL(n)+'" download="'+t+'">Download as CSV</A>'}}class c extends s{constructor(e,t,n={}){super(e,t),this.columnDelimiter=n.columnDelimiter??",",this.rowDelimiter=n.rowDelimiter??"<BR>"}render(){let e="";this.title&&(e+=`<STRONG>${this.title}</STRONG>`+this.rowDelimiter),e+=this.header.join(this.columnDelimiter)+this.rowDelimiter;return this.buildRows().forEach((t=>{e+=t.map((e=>s.formatValue(c.escapeForCSV(c.formatCSVcellvalues(e))))).join(this.columnDelimiter)+this.rowDelimiter})),e}static escapeForCSV(e){return/[",\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e}static formatCSVcellvalues(e){let t;return t="object"==typeof e?function(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].name+": "+e[n].value+";\n\r";return t}(e):String(e).trim(),t}}const d=new i({title:"Method of Web Scraping",message:"Select the method of web scraping:",options:[{label:"CSS Selector",value:"CSS"},{label:"XPath",value:"XPath"}]}),p=await d.show();var t="";if("CSS"===p){var n=prompt("Enter CSS selector for web scraping (default:A): ","A");listofObject=document.querySelectorAll(n),tableschema={"Extracted innerText":"innerText","Extracted outerHTML":"outerHTML","CSS selector attributes":"attributes"},t=n}else{if("XPath"!==p)return void alert("User has clicked 'Cancel'");{var o=prompt("Enter XPath expression for web scraping (default://A): ","//A");let e=document.evaluate(o,document,null,XPathResult.ANY_TYPE,null);listofObject=function(e){var t=[];let n=e.iterateNext();for(;n;)t.push(n),n=e.iterateNext();return t}(e),tableschema={"Extracted Text":"textContent",outerHTML:"outerHTML"},t=o}}const u=new l({"Page URL":location.href,"Page Name":document.title,"Web Scrape Method":p,"Web Scrape string":t},"WLA CSS Selector and XPath Web Scraper Tool");let h=location.href+"_"+p+"_"+t+".csv",m=u.displayPageHeaders();m+=new a(tableschema,listofObject).render(h),m+=u.displayPageFooters(),r.openWithHTML(m)}})();